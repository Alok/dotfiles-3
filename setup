#!/bin/bash

pushd ~
git init history
popd

pushd ~/config
find . -maxdepth 1 -not \
    \( -iname '*~' -or -iname '*#*' -or -iname '.' \
    -or -iname '.hg' -or -iname '.git' -or -iname 'setup' \) \
    -exec bash -c \
    "if [[ -e ~/{} && ! -L ~/{} ]]
     then
         mkdir -p ~/config-old/
         mv ~/{} ~/config-old/{}
     fi
     if [[ ! -L ~/{} ]]
     then
         ln -s $PWD/{} ~/{}
     fi" \;
popd